webpackJsonp([315],{1705:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){var a=n(38),i=n.n(a),o=n(2884),r=n(492),s=n.n(r),c=n(2886),p=n(2887),u=new c.a,m=new p.a,d={namespace:"M01328025A030LP00301",state:o.a,subscriptions:{historyListenEvent:function(e){var n=e.history,a=e.dispatch;return n.listen(function(e){var n=s()("/main/:tabIndex/0132/80/25/A/030/L/P/003/01/:paramobject/:encryptstr").exec(e.pathname);if(n){var i=t.__COMPARISON__&&t.__COMPARISON__(n);a({type:"init",routeParams:i})}})}},effects:{init:i.a.mark(function e(n,a){var r,s,c,p,d,l,f,D,h,w,g,v=a.put,b=a.call;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.routeParams.priceId,s={id:r},c={rateId:r},p=["PARA_PACKAGE_GROUP"],e.next=6,b(u.init,s,c,p);case 6:return d=e.sent,l=d.rateData,f=d.roomTyp,D=d.dictTyp,e.next=12,b(t.__GETCACHEDATA__,"M01328025A030LP00301",l,["rateBase.version"]);case 12:if(!(h=e.sent)){e.next=17;break}return e.next=16,v({type:"initComplete",data:h});case 16:return e.abrupt("return");case 17:return w=m.dealElements(o.a,l,D),w.roomtypIds.componentOptions.options=f,g=m.transferFormData(l),D.roomTyp=f,e.next=23,v({type:"initComplete",data:Object.assign({routeParams:n.routeParams,elements:w,bussinessDictionary:D},g)});case 23:case"end":return e.stop()}},e,this)}),savePrice:i.a.mark(function t(e,n){var a,o,r,s,c,p,d,l=n.select,f=n.put,D=n.call;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(function(t){return t});case 2:return a=t.sent,o=a.M01328025A030LP00301,r=o.routeParams.priceId,s=m.savePrice(o),c={rateId:r,submitData:s,displayData:a},t.next=9,D(u.saveRateSet,c);case 9:return t.next=11,D(u.getGrpRsvRate,{id:r});case 11:return p=t.sent,d=m.transferFormData(p),t.next=15,f({type:"updateRootStateProp",updateObj:d});case 15:case"end":return t.stop()}},t,this)})},reducers:{initComplete:function(t,e){return Object.assign({},t,e.data)},updateFormData:function(t,e){var n=m.onDataChange(t,e);return Object.assign({},t,n)},updateRootStateProp:function(t,e){return Object.assign({},t,e.updateObj)},new:function(t,e){var n=m.newRateData(t);return Object.assign({},t,n)},deleteOrRecover:function(t,e){var n=m.deleteOrRecover(t,e.name);return Object.assign({},t,n)}}};e.default=d}.call(e,n(15))},2215:function(t,e,n){"use strict";e.a={roomtypIds:"\u623f\u578b\u9009\u62e9",startDt:"\u5f00\u59cb\u65e5\u671f",endDt:"\u7ed3\u675f\u65e5\u671f",dowselect:"\u5468\u522b\u9009\u62e9",dowall:"\u5168\u9009",dow1:"\u5468\u4e00",dow2:"\u5468\u4e8c",dow3:"\u5468\u4e09",dow4:"\u5468\u56db",dow5:"\u5468\u4e94",dow6:"\u5468\u516d",dow0:"\u5468\u65e5",adult1Amt:"\u4e00\u4eba\u4ef7",adult2Amt:"\u4e8c\u4eba\u4ef7",adult3Amt:"\u4e09\u4eba\u4ef7",adult4Amt:"\u56db\u4eba\u4ef7",adult5Amt:"\u4e94\u4eba\u4ef7",pkggroupId:"\u623f\u542b\u5206\u7ec4",datesign:"\u81f3",dowTips:"\u8bf7\u9009\u62e9\u5468\u522b",priceTips:"\u8bf7\u8f93\u5165\u4ef7\u683c",startingTmlen:"\u8d77\u6b65\u65f6\u95f4(\u5206\u949f)",timingcellTmlen:"\u6807\u51c6\u8ba1\u8d39\u65f6\u95f4(\u5206\u949f)",timingminTmlen:"\u6700\u5c0f\u8ba1\u8d39\u65f6\u95f4(\u5206\u949f)",clockrmNights:"\u9ed8\u8ba4\u623f\u665a(\u5929)",startingAmt:"\u8d77\u6b65\u4ef7\u683c",timingAmt:"\u6807\u51c6\u8ba1\u8d39\u4ef7\u683c",timingminAmt:"\u6700\u5c0f\u8ba1\u8d39\u4ef7\u683c",timeBeyond:"\u6700\u5c0f\u8ba1\u8d39\u65f6\u95f4\u4e0d\u80fd\u5927\u4e8e\u6807\u51c6\u8ba1\u8d39\u65f6\u95f4",priceBeyond:"\u6700\u5c0f\u8ba1\u8d39\u4ef7\u683c\u4e0d\u80fd\u5927\u4e8e\u6807\u51c6\u8ba1\u8d39\u4ef7\u683c",timeNoZero:"\u6807\u51c6\u8ba1\u8d39\u65f6\u95f4\u4e0d\u80fd\u7b49\u4e8e0",btnSave:"\u4fdd\u5b58",saveSuccess:"\u4fdd\u5b58\u6210\u529f",btnBack:"\u8fd4\u56de",btnNew:"\u65b0\u5efa"}},2884:function(t,e,n){"use strict";var a=n(2215),i=n(2885);e.a={routeParams:{},elements:{roomtypIds:{type:"select",width:16,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{multiple:!0,text:a.a.roomtypIds,selection:!0}},startDt:{type:"datepicker",width:4,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:a.a.startDt}},endDt:{type:"datepicker",width:4,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:a.a.endDt}},dowall:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dowall}},dow1:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dow1}},dow2:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dow2}},dow3:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dow3}},dow4:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dow4}},dow5:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dow5}},dow6:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dow6}},dow0:{type:"checkbox",width:1,interactionOptions:{findCondition:""},componentOptions:{label:a.a.dow0}}},normalElements:{adult1Amt:{type:"input",width:4,interactionOptions:{findCondition:""},componentOptions:{text:a.a.adult1Amt}},adult2Amt:{type:"input",width:4,interactionOptions:{findCondition:""},componentOptions:{text:a.a.adult2Amt}},adult3Amt:{type:"input",width:4,interactionOptions:{findCondition:""},componentOptions:{text:a.a.adult3Amt}},adult4Amt:{type:"input",width:4,interactionOptions:{findCondition:""},componentOptions:{text:a.a.adult4Amt}},adult5Amt:{type:"input",width:4,interactionOptions:{findCondition:""},componentOptions:{text:a.a.adult5Amt}},pkggroupId:{type:"select",width:12,interactionOptions:{findCondition:""},componentOptions:{text:a.a.pkggroupId,selection:!0,enableNullValue:!0}}},hourElements:{startingTmlen:{type:"input",width:4,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:a.a.startingTmlen,checkType:"zhinteger",className:"price-hour-label"}},timingcellTmlen:{type:"input",width:4,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:a.a.timingcellTmlen,checkType:"zhinteger",className:"price-hour-label"}},timingminTmlen:{type:"input",width:4,componentOptions:{text:a.a.timingminTmlen,checkType:"zhinteger",className:"price-hour-label"}},clockrmNights:{type:"input",width:4,componentOptions:{text:a.a.clockrmNights,checkType:"zhfloat",className:"price-hour-label"}},startingAmt:{type:"input",width:4,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:a.a.startingAmt,checkType:"zhfloat",className:"price-hour-label"}},timingAmt:{type:"input",width:4,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:a.a.timingAmt,checkType:"zhfloat",className:"price-hour-label"}},timingminAmt:{type:"input",width:4,componentOptions:{text:a.a.timingminAmt,checkType:"zhfloat",className:"price-hour-label"}}},startEndDtMinMaxDate:{},rateBase:{},formData:{},openMoreName:[],newDataCount:0,bussinessDictionary:{},rightOperTop:{save:{text:a.a.btnSave,className:"icon32 img81",permsCode:i.a[328020081],keyboard:"GF08"},back:{text:a.a.btnBack,className:"icon32 img83",keyboard:"GF10"}},rightOperCenter:{new:{text:a.a.btnNew,className:"icon20 img45",keyboard:"GF16"}},rightOperBottom:{}}},2885:function(t,e,n){"use strict";e.a={328020081:["328020081","328020081G","328020081H"]}},2886:function(t,e,n){"use strict";function a(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function a(i,o){try{var r=e[i](o),s=r.value}catch(t){return void n(t)}if(!r.done)return Promise.resolve(s).then(function(t){a("next",t)},function(t){a("throw",t)});t(s)}return a("next")})}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return d});var o=n(38),r=n.n(o),s=n(257),c=n(260),p=n(489),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),m=new p.a,d=function(){function t(){var e=this;i(this,t),this.init=function(){var t=a(r.a.mark(function t(n,a,i){var o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.getGrpRsvRate(n),Object(s.a)("/bs/3130010/GrpRsvRateSet/queryRateRmTypList","get",a),m.queryDictionary(i)]);case 2:return o=t.sent,t.abrupt("return",{rateData:o[0],roomTyp:Object(c.b)(o[1].responseDto,"name","key"),dictTyp:o[2]});case 4:case"end":return t.stop()}},t,e)}));return function(e,n,a){return t.apply(this,arguments)}}(),this.getGrpRsvRate=function(t){return Object(s.a)("/bs/3130010/GrpRsvRate/getGrpRsvRate","get",t)}}return u(t,[{key:"saveRateSet",value:function(t){return Object(s.a)("/bs/3130010/GrpRsvRateSet/saveRateSet","post",t)}}]),t}()},2887:function(t,e,n){"use strict";(function(t){function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return h});var o=n(22),r=n.n(o),s=n(82),c=n.n(s),p=n(54),u=n.n(p),m=n(18),d=n.n(m),l=n(60),f=n.n(l),D=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),h=function(){function e(){var n=this;i(this,e),this.DataNamePrefix="newData",this.DowPrefix="dow",this.dealElements=function(e,n,a){var i=void 0;if("2"===n.rateBase.priceTyp){i=Object.assign({},e.elements,e.hourElements);var o=t.__OPTIONMAP__["3220-010-108"];o&&(i.timingminAmt.componentOptions.disabled="0"==o.option_str1,i.timingminTmlen.componentOptions.disabled="0"==o.option_str1,"0"==o.option_str1&&d()(n.rates,function(t,e){t.timingminAmt="",t.timingminTmlen=""}))}else i=Object.assign({},e.elements,e.normalElements),i.pkggroupId.componentOptions.options=a.PARA_PACKAGE_GROUP;return i},this.transferFormData=function(t){var e=t.rateBase,a=t.rates,i=void 0,o=[n.DataNamePrefix+"1"],r={};a.length>0?(i=a.length,a.forEach(function(t,e){t.typCRUD="5",n._convertDow(t),t.roomtypIds=t.roomtypIds.map(function(t){return""+t}),r[""+n.DataNamePrefix+ ++e]=t})):(i=1,r[n.DataNamePrefix+"1"]=n._generateNewFormData(e));var s={sdMinDate:e.startDt,sdMaxDate:e.endDt,edMinDate:e.startDt,edMaxDate:e.endDt};return{newDataCount:i,openMoreName:o,formData:r,startEndDtMinMaxDate:s,rateBase:e}},this.onDataChange=function(t,e){return"5"===e.formData.typCRUD&&(e.formData.typCRUD="3"),"startDt"===e.eventData.fieldname?n._startDtChange(t,e):u()(e.eventData.fieldname,n.DowPrefix)?n._dowChange(t,e):{formData:Object.assign({},t.formData,a({},e.name,e.formData))}},this._startDtChange=function(t,e){var n=e.formData;return n.endDt&&f()(n.startDt).isAfter(f()(n.endDt))&&(n.endDt=f()(n.startDt).add(1,"days").valueOf()),{startEndDtMinMaxDate:Object.assign({},t.startEndDtMinMaxDate,a({},e.name+"edMinDate",n.startDt)),formData:Object.assign({},t.formData,a({},e.name,n))}},this._dowChange=function(t,e){var i=e.formData,o=e.eventData.checked,r=n.DowPrefix+"all";if(e.eventData.fieldname===r)for(var s=0;s<7;s++)i[""+n.DowPrefix+s]=o;else{for(var c=!0,p=0;p<7;p++)if(!i[""+n.DowPrefix+p]){c=!1;break}i[r]=c}return{formData:Object.assign({},t.formData,a({},e.name,i))}},this.savePrice=function(t){var e=[];for(var a in t.formData){var i=Object.assign(t.formData[a]);n._convertDowToSubmitServer(i),"5"===i.typCRUD&&(i.typCRUD="3"),e.push(i)}return e},this._delete=function(t,e,i,o){if(t)return Object.assign({},e.formData,a({},i,Object.assign({},e.formData[i],{typCRUD:o})));var s=Object.assign({},e.formData);return r()(s)>1?(delete s[i],s):a({},i,n._generateNewFormData(e.rateBase))},this._recover=function(t,e,n){return Object.assign({},t.formData,a({},e,Object.assign({},t.formData[e],{typCRUD:n})))},this._convertDowToSubmitServer=function(t){for(var e={},a=0;a<7;a++){var i=""+n.DowPrefix+a;e[a]=t[i]?"1":"0",delete t[i]}delete t[n.DowPrefix+"all"],t.dow=e}}return D(e,[{key:"newRateData",value:function(t){var e=t.newDataCount,n=Object.assign([],t.openMoreName);e++;var i=""+this.DataNamePrefix+e;n.push(i);var o=this._generateNewFormData(t.rateBase);return{newDataCount:e,openMoreName:n,formData:Object.assign({},t.formData,a({},i,o))}}},{key:"deleteOrRecover",value:function(t,e){var n=t.formData[e].typCRUD,a=t.formData[e].rateSetId,i="4"!==n?"4":a?"3":"1",o=Object.assign([],t.openMoreName),r=c()(o,function(t){return t===e}),s=void 0;if("4"!==n){-1!==r&&o.splice(r,1);var p=!!a;s=this._delete(p,t,e,i)}else-1===r&&o.push(e),s=this._recover(t,e,i);return{openMoreName:o,formData:s}}},{key:"_generateNewFormData",value:function(t){var e={roomtypIds:[],startDt:t.startDt,endDt:t.endDt,dow0:!1,dow1:!1,dow2:!1,dow3:!1,dow4:!1,dow5:!1,dow6:!1,dowall:!1,typCRUD:"1"};return e="2"===t.priceTyp?Object.assign({},e,{startingTmlen:"",timingcellTmlen:"",timingminTmlen:"",clockrmNights:"",startingAmt:"",timingAmt:"",timingminAmt:""}):Object.assign({},e,{adult1Amt:"",adult2Amt:"",adult3Amt:"",adult4Amt:"",adult5Amt:"",pkggroupId:""})}},{key:"_convertDow",value:function(t){var e=!0;for(var n in t.dow){var a=""+this.DowPrefix+n,i=t.dow[n];e&&"0"==i&&(e=!1),t[a]="1"==i}t[this.DowPrefix+"all"]=e,delete t.dow}}]),e}()}).call(e,n(15))}});