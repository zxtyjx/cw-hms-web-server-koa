webpackJsonp([270],{1568:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(38),a=n.n(r),i=n(256),o=n.n(i),s=n(2701),p=n(2703),u=n(2704),c=new p.a,d=new u.a,m={namespace:"M01325010A020LP00201",state:s.a,effects:{init:a.a.mark(function t(e,n){var r,i,p,u,m,f,l,O,R,h=n.select,v=n.put,b=n.call;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h(function(t){return t.M01325010A020LP00201});case 2:return r=t.sent,i=["REPIARRSN"],t.next=6,b(c.init,e.editIds,i);case 6:return p=t.sent,u=p.repairData,m=p.dictTyps,f=o()(s.a.elements),f.repairrsnId.componentOptions.options=m.REPIARRSN,d.handleOptionMap(e.optionMap,f),l=void 0,O=void 0,R=void 0,e.editIds?(l=r.repairTypPermsMapping[u[0].repairTyp].update,O=d.handleEleInUpdate(u,f),R=!0):(l=r.repairTypPermsMapping.OOS.add,O=Object.assign({},s.a.formData,{roomNum:e.roomNum?e.roomNum.join(","):""}),R=!1),t.next=16,v({type:"initComplete",data:Object.assign({},s.a,{elements:f,formData:O,btnPermsCode:l,isEdit:R,repairData:u})});case 16:case"end":return t.stop()}},t,this)}),batchSaveHptHkRoomRepair:a.a.mark(function t(e,n){var r,i,o,s=n.call,p=n.put;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=d.setRepair(e.paramdata),i="batchSaveHptHkRoomRepair"+e.paramdata.repairTyp,t.next=4,s(c[i],r);case 4:if(o=t.sent,!o.resultInfo){t.next=7;break}throw o.resultInfo;case 7:if(e.close(),!e.callbackFuntion){t.next=12;break}e.callbackFuntion(),t.next=15;break;case 12:return e.isSkip=!0,t.next=15,p({type:"M01325010A010LT00101/queryRoomList"});case 15:case"end":return t.stop()}},t,this)}),batchUpdateHptHkRoomRepair:a.a.mark(function t(e,n){var r,i,o,s,p=n.select,u=n.call,m=n.put;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p(function(t){return t.M01325010A020LP00201});case 2:return r=t.sent,i=d.editRepair(r),o="batchUpdateHptHkRoomRepair"+i.repairTyp,t.next=7,u(c[o],{submitData:i});case 7:if(s=t.sent,!s.resultInfo){t.next=10;break}throw s.resultInfo;case 10:if(e.close(),!e.callbackFuntion){t.next=15;break}e.callbackFuntion(),t.next=18;break;case 15:return e.isSkip=!0,t.next=18,m({type:"M01325010A010LT00101/queryRoomList"});case 18:case"end":return t.stop()}},t,this)})},reducers:{initComplete:function(t,e){return Object.assign({},t,e.data)},updateFormData:function(t,e){var n=d.updateFormData(t,e.data);return Object.assign({},t,n)}}};e.default=m},1929:function(t,e,n){function r(t,e){return e=a(e,t),null==(t=o(t,e))||delete t[s(i(e))]}var a=n(84),i=n(110),o=n(491),s=n(62);t.exports=r},1931:function(t,e,n){function r(t,e){for(var n=t?e.length:0,r=n-1;n--;){var o=e[n];if(n==r||o!==p){var p=o;i(o)?s.call(t,o,1):a(t,o)}}return t}var a=n(1929),i=n(85),o=Array.prototype,s=o.splice;t.exports=r},1932:function(t,e,n){function r(t,e){var n=[];if(!t||!t.length)return n;var r=-1,o=[],s=t.length;for(e=a(e,3);++r<s;){var p=t[r];e(p,r,t)&&(n.push(p),o.push(r))}return i(t,o),n}var a=n(32),i=n(1931);t.exports=r},2248:function(t,e,n){"use strict";e.a={repairTyp:"\u6545\u969c\u623f\u5c5e\u6027",repairTypOptOOS:"\u7ef4\u4fee\u623f",repairTypOptOOO:"\u505c\u7528\u623f",repairTypOptNBA:"\u4e34\u65f6\u9501\u623f",startDt:"\u5f00\u59cb\u65e5\u671f",endDt:"\u7ed3\u675f\u65e5\u671f",roomNum:"\u623f\u53f7",roomNumPh:"\u8bf7\u8f93\u5165\u623f\u53f7\uff0c\u4ee5\u9017\u53f7\u5206\u9694",repairrsnId:"\u7ef4\u4fee\u539f\u56e0",returnSts:"\u89e3\u9664\u540e\u72b6\u6001",returnStsC:"\u5e72\u51c0",returnStsD:"\u810f",returnStsI:"\u5f85\u67e5",returnStsT:"\u8f7b\u810f",repairrsnRemarks:"\u5907\u6ce8",confirm:"\u786e\u5b9a",cancel:"\u53d6\u6d88",setRepairSuccess:"\u8bbe\u7f6e\u6210\u529f",editRepairSuccess:"\u4fee\u6539\u6210\u529f"}},2701:function(t,e,n){"use strict";(function(t){var r=n(2248),a=n(2702),i=n(60),o=n.n(i);e.a={isEdit:!1,groupOptions:[{inline:!1},{inline:!1},{inline:!1},{inline:!1},{inline:!1,className:"room-repair-lastField"}],elements:{repairTyp:{type:"select",width:16,groupIndex:0,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:r.a.repairTyp,options:[{value:"OOS",text:r.a.repairTypOptOOS},{value:"OOO",text:r.a.repairTypOptOOO},{value:"NBA",text:r.a.repairTypOptNBA}],selection:!0}},startDt:{type:"datepicker",width:8,groupIndex:1,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:r.a.startDt,minDate:t.__BUSINESSDT__}},endDt:{type:"datepicker",width:8,groupIndex:1,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:r.a.endDt,minDate:t.__BUSINESSDT__}},roomNum:{type:"input",width:16,groupIndex:2,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:r.a.roomNum,placeholder:r.a.roomNumPh}},repairrsnId:{type:"select",width:8,groupIndex:3,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:r.a.repairrsnId,selection:!0}},returnSts:{type:"select",width:8,groupIndex:3,interactionOptions:{isMust:!0,findCondition:""},componentOptions:{text:r.a.returnSts,selection:!0,options:[{value:"C",text:r.a.returnStsC},{value:"D",text:r.a.returnStsD},{value:"I",text:r.a.returnStsI},{value:"T",text:r.a.returnStsT}]}},repairrsnRemarks:{type:"input",width:16,groupIndex:4,componentOptions:{text:r.a.repairrsnRemarks}}},formData:{repairTyp:"OOS",startDt:t.__BUSINESSDT__,endDt:o()(Number(t.__BUSINESSDT__)).add("1","days").valueOf(),roomNum:"",repairrsnId:"",returnSts:"C",repairrsnRemarks:""},repairTypPermsMapping:{OOS:{add:a.a[32500141],update:a.a[32500142]},OOO:{add:a.a[32500151],update:a.a[32500152]},NBA:{add:a.a[32500131],update:a.a[32500132]}},btnPermsCode:"",repairData:{}}}).call(e,n(15))},2702:function(t,e,n){"use strict";e.a={32500141:["32500141","32500141G","32500141H"],32500142:["32500142","32500142G","32500142H"],32500151:["32500151","32500151G","32500151H"],32500152:["32500152","32500152G","32500152H"],32500131:["32500131","32500131G","32500131H"],32500132:["32500132","32500132G","32500132H"]}},2703:function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(a,i){try{var o=e[a](i),s=o.value}catch(t){return void n(t)}if(!o.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}return r("next")})}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return d});var i=n(38),o=n.n(i),s=n(257),p=n(489),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=new p.a,d=function(){function t(){var e=this;a(this,t),this.init=function(){var t=r(o.a.mark(function t(n,r){var a,i,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=void 0,!n){t.next=8;break}return t.next=4,Promise.all([e.getHptHkRoomRepairByIds(n),c.queryDictionary(r)]);case 4:i=t.sent,a={repairData:i[0],dictTyps:i[1]},t.next=12;break;case 8:return t.next=10,c.queryDictionary(r);case 10:s=t.sent,a={dictTyps:s};case 12:return t.abrupt("return",a);case 13:case"end":return t.stop()}},t,e)}));return function(e,n){return t.apply(this,arguments)}}(),this.getHptHkRoomRepairByIds=function(){var t=r(o.a.mark(function t(n){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.a)("/bs/3250010/HptHkRoomRepair/getHptHkRoomRepairByIds","get",{ids:n});case 2:return r=t.sent,t.abrupt("return",r.resultData);case 4:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()}return u(t,[{key:"batchSaveHptHkRoomRepairOOS",value:function(t){return Object(s.a)("/bs/3250010/HptHkRoomRepair/batchSaveHptHkRoomRepairOOS","post",{submitData:t})}},{key:"batchSaveHptHkRoomRepairOOO",value:function(t){return Object(s.a)("/bs/3250010/HptHkRoomRepair/batchSaveHptHkRoomRepairOOO","post",{submitData:t})}},{key:"batchSaveHptHkRoomRepairNBA",value:function(t){return Object(s.a)("/bs/3250010/HptHkRoomRepair/batchSaveHptHkRoomRepairNBA","post",{submitData:t})}},{key:"batchUpdateHptHkRoomRepairOOS",value:function(t){return Object(s.a)("/bs/3250010/HptHkRoomRepair/batchUpdateHptHkRoomRepairOOS","post",t)}},{key:"batchUpdateHptHkRoomRepairOOO",value:function(t){return Object(s.a)("/bs/3250010/HptHkRoomRepair/batchUpdateHptHkRoomRepairOOO","post",t)}},{key:"batchUpdateHptHkRoomRepairNBA",value:function(t){return Object(s.a)("/bs/3250010/HptHkRoomRepair/batchUpdateHptHkRoomRepairNBA","post",t)}}]),t}()},2704:function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return l});var i=n(43),o=n.n(i),s=n(258),p=n.n(s),u=n(1932),c=n.n(u),d=n(60),m=n.n(d),f=n(88),l=function t(){var e=this;a(this,t),this.handleOptionMap=function(t,e){t.isHasInspect||c()(e.returnSts.componentOptions.options,function(t){return"I"===t.value}),t.isHasLightDirty||c()(e.returnSts.componentOptions.options,function(t){return"T"===t.value}),t.isHasLockRoom||c()(e.repairTyp.componentOptions.options,function(t){return"NBA"===t.value})},this.handleEleInUpdate=function(t,e){for(var n=Object.assign({},t[0]),r=[n.roomNum],a=1;a<t.length;a++){var i=t[a];!n.startDt||n.startDt===i.startDt&&n.endDt===i.endDt||(delete n.startDt,delete n.endDt),n.repairrsnId&&n.repairrsnId!==i.repairrsnId&&delete n.repairrsnId,n.returnSts&&n.returnSts!==i.returnSts&&delete n.returnSts,n.repairrsnRemarks&&n.repairrsnRemarks!==i.repairrsnRemarks&&delete i.repairrsnRemarks,r.push(i.roomNum)}return n.roomNum=r.join(","),p()(r).length!==r.length&&(e.startDt.componentOptions.disabled=!0,e.startDt.interactionOptions.isMust=!1,e.endDt.componentOptions.disabled=!0,e.endDt.interactionOptions.isMust=!1),e.roomNum.componentOptions.disabled=!0,n},this.updateFormData=function(t,n){var r={},a=n.eventData.value;return"repairTyp"===n.eventData.fieldname?r.btnPermsCode=e._repairTypChange(t,a):"startDt"===n.eventData.fieldname&&(r.elements=Object.assign({},t.elements,{endDt:Object.assign({},t.elements.endDt,{componentOptions:Object.assign({},t.elements.endDt.componentOptions,{minDate:a})})}),n.formData.endDt&&m()(a).isAfter(m()(n.formData.endDt))&&(n.formData.endDt=m()(a).add(1,"days").valueOf())),r.formData=n.formData,r},this._repairTypChange=function(t,e){return t.isEdit?e!==t.repairData[0].repairTyp?t.repairTypPermsMapping[e].add:t.repairTypPermsMapping[e].update:t.repairTypPermsMapping[e].add},this.setRepair=function(t){return e._transferRoomNum(t.roomNum).map(function(e){return Object.assign({},t,{roomNum:e})})},this.editRepair=function(t){return t.formData},this._transferRoomNum=function(t){var e=Object(f.b)(t,"\uff0c",",");return[].concat(r(new Set(o()(e,",").split(","))))}}}});